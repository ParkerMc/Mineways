var n=void 0,s=!0,v=null,B=!1;
function N(f,c,p){function m(a,b,g){var d,e;d=Math.min(a,b,g);e=Math.max(a,b,g);if(0==e)return[0,0,0];var r=e-d;d=r/e;if(0==d)return[0,d,e/255];a=(a==e?(b-g)/r:b==e?2+(g-a)/r:4+(a-b)/r)/6;0>a&&(a+=1);return[a,d,e/255]}function o(a,b,g){var d,e,r,a=6*a,c=Math.floor(a),h=a-c,a=g*(1-b),y=g*(1-h*b),b=g*(1-(1-h)*b);switch(c%6){case 0:d=g;e=b;r=a;break;case 1:d=y;e=g;r=a;break;case 2:d=a;e=g;r=b;break;case 3:d=a;e=y;r=g;break;case 4:d=b;e=a;r=g;break;case 5:d=g,e=a,r=y}return[Math.round(255*d),Math.round(255*
e),Math.round(255*r)]}function t(a,b,g){for(var d=4*(g-3)*h+4*(b-3),e=0,g=0;7>g;g++,d+=4*h-28)for(b=0;7>b;b++,e++)if("."=="..111...10001.10...0110...0110...01.10001...111.."[e])d+=4;else{var r;r="1"=="..111...10001.10...0110...0110...01.10001...111.."[e]?0:255;a.data[d++]=r;a.data[d++]=r;a.data[d++]=r;a.data[d++]=255}}function k(){G.putImageData(H,0,0);for(var a=G.getImageData(0,0,h,h),b=Math.round(h/2-j/2),g=Math.round(h/2+j/2),d=b;d<g;d++)for(var e=(d-b)/j,r=4*d*h+4*b,c=b;c<g;c++){var y=o(z[0],
(c-b)/j,1-e);a.data[r++]=y[0];a.data[r++]=y[1];a.data[r++]=y[2];a.data[r++]=255}g=2*z[0]*Math.PI;d=h/2-P/2;c=Math.round(Math.cos(g)*d+h/2);d=Math.round(h/2-Math.sin(g)*d);t(a,c,d);c=Math.round(z[1]*j+b);d=Math.round((1-z[2])*j+b);t(a,c,d);G.putImageData(a,0,0)}function x(){var b=o(z[0],z[1],z[2]);l=b[0];e=b[1];d=b[2];c=l<<16|e<<8|d;q();w();a()}function i(){a();z=m(l,e,d);k()}function q(){for(var a=c.toString(16);6>a.length;)a="0"+a;I.val(a)}function w(){g.val(String(l));K.val(String(e));L.val(String(d))}
function a(){u.css("background","rgb("+l+","+e+","+d+")")}var l=c>>16&255,e=c>>8&255,d=c&255,h=200,P=10,Q=[0,0,0,0],b=h-2*P-2,j=Math.sqrt(b*b/2),C=$(document.createElement("div"));C.addClass("picker");f=f.offset();C.css("top",f.top+"px");C.css("left",f.left+"px");$(document.body).append(C);var A=$(document.createElement("canvas"));A.attr("width",h);A.attr("height",h);A.css("float","left");C.append(A);f=$(document.createElement("div"));f.css("float","left");C.append(f);var u=$(document.createElement("div"));
u.addClass("swatch");f.append(u);var I=$(document.createElement("input"));I.attr("type","text");I.addClass("hexcolor");I.keyup(function(){c=parseInt(I.val(),16);l=c>>16&255;e=c>>8&255;d=c&255;z=m(l,e,d);w();a();k()});f.append(I);f.append($(document.createElement("div")).addClass("colorlabel").text("R:"));var g=$(document.createElement("input"));g.attr("type","text");g.addClass("colorinput");g.keyup(function(){l=parseInt(g.val(),10)&255;c&=65535;c|=l<<16;q();i()});f.append(g);f.append($(document.createElement("div")).addClass("colorlabel").text("G:"));
var K=$(document.createElement("input"));K.attr("type","text");K.addClass("colorinput");K.keyup(function(){e=parseInt(K.val(),10)&255;c&=16711935;c|=e<<8;q();i()});f.append(K);f.append($(document.createElement("div")).addClass("colorlabel").text("B:"));var L=$(document.createElement("input"));L.attr("type","text");L.addClass("colorinput");L.keyup(function(){d=parseInt(L.val(),10)&255;c&=16776960;c|=d;q();i()});f.append(L);b=$(document.createElement("div"));b.css("clear","left");b.css("padding-top",
"10px");f.append(b);var E=$(document.createElement("button"));E.css("float","right");E.text("Okay");E.click(function(){C.remove();p(l<<16|e<<8|d)});b.append(E);var F=$(document.createElement("button"));F.css("float","right");F.text("Cancel");F.click(function(){C.remove()});b.append(F);f=$(document.createElement("br"));f.css("clear","left");C.append(f);I.focus();C.keyup(function(a){return 13==a.keyCode?(E.click(),B):27==a.keyCode?(F.click(),B):s});A.mousedown(function(a){var b=a.offsetX,a=a.offsetY,
d=Math.round(h/2-j/2),g=Math.round(h/2+j/2);if(b>=d&&b<g&&a>=d&&a<g){var e=b,r=a,c=Math.round(h/2-j/2),y=Math.round(h/2+j/2);z[1]=(e-c)/j;z[2]=1-(r-c)/j;k();x();$(A).mousemove(function(a){e=a.offsetX;r=a.offsetY;e<c&&(e=c);e>y&&(e=y);r<c&&(r=c);r>y&&(r=y);z[1]=(e-c)/j;z[2]=1-(r-c)/j;k();x();return B});$(A).mouseup(function(){$(A).unbind("mousemove");$(A).unbind("mouseup");return B})}else{var d=h/2,f=a-h/2,l=b-h/2,b=Math.sqrt(l*l+f*f);b>=h/2-P&&b<d&&(z[0]=1+Math.atan2(-f,l)/(2*Math.PI),k(),x(),$(A).mousemove(function(a){f=
a.offsetY-h/2;l=a.offsetX-h/2;z[0]=1+Math.atan2(-f,l)/(2*Math.PI);k();x();return B}),$(A).mouseup(function(){$(A).unbind("mousemove");$(A).unbind("mouseup");return B}))}return B});for(var G=A[0].getContext("2d"),H,f=G.createImageData(h,h),b=0,D=h/2,O=h/2-P,r=0;r<h;r++)for(var y=r-h/2,T=y*y,R=0;R<h;R++){var J=R-h/2,M=Math.sqrt(J*J+T);M>=O&&M<D?(J=o(1+Math.atan2(-y,J)/(2*Math.PI),1,1),f.data[b++]=J[0],f.data[b++]=J[1],f.data[b++]=J[2],1>D-M?f.data[b++]=255*(D-M):1>M-O?f.data[b++]=255*(M-O):f.data[b++]=
255):(f.data[b++]=Q[0],f.data[b++]=Q[1],f.data[b++]=Q[2],f.data[b++]=Q[3])}H=f;var z=m(l,e,d);x();k()};function S(){function f(a,d){for(var b=0;b<a.length;b++)d?a[b].removeAttr("disabled"):a[b].attr("disabled","disabled")}var c=new U,p=new V(function(){o.empty();for(var d in p.f)o.append(c.b({option:p.f[d].name,val:d}));k.empty();for(var e in p.d)k.append(c.b({option:p.d[e].name+" ("+p.d[e].type+")",val:e}));a.empty();for(d in p.e)a.append(c.b({option:p.e[d].name,val:d}));o.trigger("change");k.trigger("change");a.trigger("change")},c),m=new W(p,c),o=c.b({select:v,size:"6"}),t=c.b({button:"Generate",
disabled:"true"});t.click(function(){m.g(o.children(":selected").val(),B)});o.change(function(){f([t],0<o.children(":selected").length)});var k=c.b({select:v,size:"6"}),x=c.b({button:"Add Mod"});x.click(p.add);var i=c.b({button:"Modify Mod",disabled:"true"});i.click(function(){p.modify(k.children(":selected").val())});var q=c.b({button:"Remove Mod",disabled:"true"});q.click(function(){p.remove(k.children(":selected").val())});var w=c.b({button:"Export Mod",disabled:"true"});w.click(function(){p.j(k.children(":selected").val())});
k.change(function(){f([i,q,w],0<k.children(":selected").length)});var a=c.b({select:v,size:"6"}),l=c.b({button:"Add Pack"});l.click(p.i);var e=c.b({button:"Modify Pack",disabled:"true"});e.click(function(){p.k(a.children(":selected").val())});var d=c.b({button:"Generate",disabled:"true"});d.click(function(){m.g(a.children(":selected").val(),s)});var h=c.b({button:"Remove Pack",disabled:"true"});h.click(function(){p.l(a.children(":selected").val())});a.change(function(){f([e,d,h],0<a.children(":selected").length)});
c.c([{h1:"Minutor Pack Builder"},{div:[{h4:"Pre-made Packs"},o],css:{"float":"left"}},{div:[{h4:"&nbsp;"},t],css:{"float":"left"}},{div:[{h4:"Your Mods"},k],css:{clear:"left","float":"left"}},{div:[{h4:"&nbsp;"},x,i,q,w],css:{"float":"left"}},{div:[{h4:"Your Packs"},a],css:{"float":"left"}},{div:[{h4:"&nbsp;"},l,e,h,d],css:{"float":"left"}}])}$(document).ready(function(){new S});function V(f,c){function p(a){$.getJSON("mods/"+a,function(d){i[a]=d;l--;l||f()})}function m(){for(var a in w)delete w[a];var d=window.localStorage.getItem("localmods");if(d!=v)for(a in d=window.JSON.parse(String(d)),d)w[a]=d[a]}function o(){window.localStorage.setItem("localmods",window.JSON.stringify(w))}function t(){a.length=0;var e=window.localStorage.getItem("localpacks");if(e!=v)for(var e=window.JSON.parse(String(e)),d=0;d<e.length;d++)a.push(e[d])}function k(){window.localStorage.setItem("localpacks",
window.JSON.stringify(a))}function x(a){var d=a.name.toLowerCase().replace(/[^a-z0-9]/g,""),c;"block"==a.type?c="_ids.json":"biome"==a.type?c="_biomes.json":"dimension"==a.type&&(c="_dims.json");for(var f=d+c,l=1;f in w;)l++,f=d+l+c;w[f]=a;o()}var i={};this.h=i;var q=[];this.f=q;var w={};this.d=w;var a=[];this.e=a;var l=1;$.getJSON("mods/mods.json",function(a){l+=a.length;for(var d=0;d<a.length;d++)i[a[d]]=v,p(a[d])});$.getJSON("mods/packs.json",function(a){for(var d=0;d<a.length;d++)q.push(a[d]);
l--;l||f()});m();t();this.add=function(){var a=new X(c,["Create","Cancel"],function(a){if(!(1==a||""==p.val())){var a={name:p.val(),type:"",version:"0.0.1",data:[]},b=l.children(":selected").val();-1==b?a.type="block":-2==b?a.type="biome":-3==b?a.type="dimension":(a.type=i[b].type,a.data=i[b].data.slice(),a.version=i[b].version,i[b].configs!==n&&(a.configs=i[b].configs.slice()));x(a);f()}}),d=[{option:"New mod blocks",val:"-1"},{option:"New mod biomes",val:"-2"},{option:"New mod dimensions",val:"-3"}],
h;for(h in i)d.push({option:"Copy "+i[h].name+" ("+i[h].type+")",val:h});var l=c.b({select:d}),p=c.b({input:v,type:"text",size:"30"}),b=c.b({div:"or drop an exported mod here","class":"droptarget"});a.c([{h4:"Add Mod"},{dl:[{dt:"Type:"},{dd:l},{dt:"Name:"},{dd:p}]},b]);p.focus();b.bind({dragover:function(){b.addClass("active");return B},dragleave:function(){b.removeClass("active");return B},dragend:function(){b.removeClass("active");return B},drop:function(b){try{var d=b.originalEvent.dataTransfer.items[0].getAsFile(),
c=new FileReader;c.onload=function(b){a.close();x(window.JSON.parse(b.target.result));f()};c.readAsText(d)}catch(h){}return B}})};this.modify=function(a){function d(){var a=parseInt($(window).scrollTop(),10);D.empty();switch(g.type){case "block":D.append(c.b(h()));break;case "biome":D.append(c.b(b()));break;case "dimension":D.append(c.b(i()));break;default:throw"Unknown type: "+g.type;}$(window).scrollTop(a)}function h(){for(var a=[],b=0;b<g.data.length;b++){var e=c.b({button:"Modify"});e.click(function(a){return function(){l(a)}}(b));
var h=c.b({button:"Delete"});h.click(function(a){return function(){confirm("Are you sure you wish to delete "+g.data[a].name+"?")&&(g.data.splice(a,1),d())}}(b));a.push({tr:[{td:g.data[b].config!==n?g.data[b].config:String(g.data[b].id)},{td:g.data[b].name},{td:e},{td:h}]});if(g.data[b].variants)for(var f=0;f<g.data[b].variants.length;f++)e=c.b({button:"Modify"}),e.click(function(a,b){return function(){p(a,b)}}(b,f)),h=c.b({button:"Delete"}),h.click(function(a,b){return function(){confirm("Are you sure you wish to delete this variant?")&&
(g.data[a].variants.splice(b,1),0==g.data[a].variants.length&&delete g.data[a].variants,d())}}(b,f)),a.push({tr:[{td:String(g.data[b].variants[f].data),"class":"variant"},{td:g.data[b].variants[f].name},{td:e},{td:h}],"class":"variant"});e=c.b({a:"[Add Variant]",href:"#"});e.click(function(a){return function(){p(a,-1);return B}}(b));a.push({tr:[{td:v},{td:e}],"class":"variant"})}b=c.b({a:"[Add Block]",href:"#"});b.click(function(){l(-1);return B});a.push({tr:[{td:b}]});return{table:a}}function l(a){var b=
new X(c,["Save","Cancel"],function(b){if(0==b){-1==a&&(a=g.data.length,g.data[a]={});h.val();$.isNumeric(h.val())?(g.data[a].id=parseInt(h.val(),10),delete g.data[a].config):(g.data[a].config=h.val().trim(),delete g.data[a].id);g.data[a].name=f.val().trim();b=parseInt(q.val(),10)/100;if(0!=b){for(var e=j.toString(16);6>e.length;)e="0"+e;g.data[a].color=e;1!=b?g.data[a].alpha=b:delete g.data[a].alpha}else delete g.data[a].color,delete g.data[a].alpha;for(e=b=0;e<k.length;e++)k[e].is(":checked")&&(b|=
parseInt(k[e].val(),10));0!=b?g.data[a].flags=b:delete g.data[a].flags;b=parseInt(p.val(),10);15!=b&&0!=b?g.data[a].mask=b:delete g.data[a].mask;u();d()}}),e="";-1!=a&&(e=g.data[a].config!==n?g.data[a].config:String(g.data[a].id));var h=c.b({input:v,type:"text",val:e,size:"30"}),f=c.b({input:v,type:"text",val:-1!=a?g.data[a].name:"",size:"30"}),e=15;-1!=a&&g.data[a].mask!==n&&(e=g.data[a].mask);var p=c.b({input:v,type:"text",size:"2",val:String(e)}),j=0;-1!=a&&g.data[a].color!==n&&(j=parseInt(g.data[a].color,
16));var i=c.b({div:v,"class":"color"});i.css("background","rgb("+(j>>16)+","+(j>>8&255)+","+(j&255)+")");i.click(function(){N(i,j,function(a){j=a;i.css("background","rgb("+(a>>16)+","+(a>>8&255)+","+(a&255)+")")})});e=100;-1!=a&&(g.data[a].color===n?e=0:g.data[a].alpha!==n&&(e=Math.round(100*g.data[a].alpha)));var q=c.b({input:v,type:"text",size:"4",val:String(e)}),k=[c.b({input:v,type:"checkbox",val:1}),c.b({input:v,type:"checkbox",val:2}),c.b({input:v,type:"checkbox",val:4})];if(-1!=a)for(e=0;e<
k.length;e++)g.data[a].flags&k[e].val()&&k[e].attr("checked","checked");b.c([{dl:[{dt:"ID:"},{dd:h},{dt:"Name:"},{dd:f},{dt:"Color:"},{dd:i},{dt:"Alpha:"},{dd:q},{dt:"Flags:"},{dd:[{label:[k[0],"Transparent"]},{label:[k[1],"Transp. Solid"]},{label:[k[2],"Fluid"]}]},{dt:"Damage Mask:"},{dd:p}]}]);h.focus()}function p(a,b){var e=new X(c,["Save","Cancel"],function(e){if(0==e&&$.isNumeric(h.val())){g.data[a].variants===n&&(g.data[a].variants=[]);-1==b&&(b=g.data[a].variants.length,g.data[a].variants[b]=
{});g.data[a].variants[b].data=parseInt(h.val(),10);e=j.val().trim();e!==g.data[a].name&&""!=e?g.data[a].variants[b].name=e:delete g.data[a].variants[b].name;for(e=l.toString(16);6>e.length;)e="0"+e;g.data[a].color==n||e!==g.data[a].color?g.data[a].variants[b].color=e:delete g.data[a].variants[b].color;u();d()}}),h=c.b({input:v,type:"text",val:-1!=b?g.data[a].variants[b].data:"",size:"4"}),f=g.data[a].name,l=0;g.data[a].color!==n&&(l=parseInt(g.data[a].color,16));-1!=b&&(g.data[a].variants[b].name!==
n&&(f=g.data[a].variants[b].name),g.data[a].variants[b].color!==n&&(l=parseInt(g.data[a].variants[b].color,16)));var j=c.b({input:v,type:"text",val:f,size:"40"}),i=c.b({div:v,"class":"color",css:{background:"rgb("+(l>>16)+","+(l>>8&255)+","+(l&255)+")"}});i.click(function(){N(i,l,function(a){l=a;i.css("background","rgb("+(a>>16)+","+(a>>8&255)+","+(a&255)+")")})});e.c([{dl:[{dt:"Damage:"},{dd:h},{dt:"Name:"},{dd:j},{dt:"Color:"},{dd:i}]}]);h.focus()}function b(){for(var a=[],b=0;b<g.data.length;b++){var e=
c.b({button:"Modify"});e.click(function(a){return function(){j(a)}}(b));var h=c.b({button:"Delete"});h.click(function(a){return function(){confirm("Are you sure you wish to delete "+g.data[a].name+"?")&&(g.data.splice(a,1),d())}}(b));a.push({tr:[{td:g.data[b].config!==n?g.data[b].config:String(g.data[b].id)},{td:g.data[b].name},{td:e},{td:h}]})}b=c.b({a:"[Add Biome]",href:"#"});b.click(function(){j(-1);return B});a.push({tr:[{td:b}]});return{table:a}}function j(a){var b=new X(c,["Save","Cancel"],
function(b){0==b&&(-1==a&&(a=g.data.length,g.data[a]={}),h.val(),$.isNumeric(h.val())?(g.data[a].id=parseInt(h.val(),10),delete g.data[a].config):(g.data[a].config=h.val().trim(),delete g.data[a].id),g.data[a].name=f.val().trim(),u(),d())}),e="";-1!=a&&(e=g.data[a].config!==n?g.data[a].config:String(g.data[a].id));var h=c.b({input:v,type:"text",val:e,size:"40"}),f=c.b({input:v,type:"text",val:-1!=a?g.data[a].name:"",size:"40"});b.c([{dl:[{dt:"ID:"},{dd:h},{dt:"Name:"},{dd:f}]}]);h.focus()}function i(){for(var a=
[],b=0;b<g.data.length;b++){var e=c.b({button:"Modify"});e.click(function(a){return function(){q(a)}}(b));var h=c.b({button:"Delete"});h.click(function(a){return function(){confirm("Are you sure you wish to delete "+g.data[a].name+"?")&&(g.data.splice(a,1),d())}}(b));a.push({tr:[{td:g.data[b].name},{td:e},{td:h}]})}b=c.b({a:"[Add Dimension]",href:"#"});b.click(function(){q(-1);return B});a.push({tr:[{td:b}]});return{table:a}}function q(a){var b=new X(c,["Save","Cancel"],function(b){0==b&&(-1==a&&
(a=g.data.length,g.data[a]={}),g.data[a].name=e.val().trim(),g.data[a].path=h.val().trim(),g.data[a].scale=parseInt(f.val(),10),l.is(":checked")?g.data[a].regex=s:delete g.data[a].regex,d())}),e=c.b({input:v,type:"text",val:-1!=a?g.data[a].name:"",size:"40"}),h=c.b({input:v,type:"text",val:-1!=a?g.data[a].path:"",size:"50"}),f=c.b({input:v,type:"text",size:"2",val:-1!=a?String(g.data[a].scale):"1"}),l=c.b({input:v,type:"checkbox",val:1});-1!=a&&g.data[a].regex==s&&l.attr("checked","checked");b.c([{dl:[{dt:"Name:"},
{dd:e},{dt:"Path:"},{dd:h},{dd:{label:[l,"Path is Regex"]}},{dt:"Scale:"},{dd:f}]}]);e.focus()}function u(){g.data.sort(function(a,b){return a.id!==n&&b.id!==n?a.id-b.id:a.id!==n?-1:b.id!==n?1:a.config==b.config?0:a.config>b.config?1:-1});for(var a=0;a<g.data.length;a++)g.data[a].variants!==n&&g.data[a].variants.sort(function(a,b){return a.data-b.data})}var k=c.save(),g=w[a],t=c.b({input:v,type:"text",val:g.name,size:"40"}),x=c.b({input:v,type:"text",val:g.version,size:"8"}),a="";g.configs!=n&&(a=
g.configs.join(", "));var E=c.b({input:v,type:"text",val:a,size:"40"}),a="";g.update!=n&&(a=g.update);var F=c.b({input:v,type:"text",size:"50",val:a}),a=c.b({button:"Save",css:{"float":"right"}});a.click(function(){var a=t.val().trim();if(""==a)alert("You must give this mod a name");else{g.name=a;g.version=x.val().trim();a=E.val().split(",");if(0<a.length){g.configs=[];for(var b=0;b<a.length;b++){var e=a[b].trim();""!=e&&g.configs.push(e)}}else delete g.configs;0==g.configs.length&&delete g.configs;
a=F.val().trim();""!=a?g.update=a:delete g.update;$(window).unbind("scroll");c.restore(k);o();f()}});var G=c.b({button:"Cancel",css:{"float":"right"}});G.click(function(){m();$(window).unbind("scroll");c.restore(k)});var H=c.b({div:[a,G,{br:v,css:{clear:"right"}}],"class":"buttonbar"}),D=c.b({div:v});c.c([{h1:"Modify Mod"},{table:[{tr:[{th:"Name:"},{td:t}]},{tr:[{th:"Version:"},{td:x}]},{tr:[{th:"Configs:"},{td:E}]},{tr:[{th:"Update:"},{td:F}]}]},H,D,{div:v,css:{height:"100px"}}]);t.focus();d();var O=
H.offset().top;$(window).scroll(function(){$(window).scrollTop()>O?H.css({position:"fixed"}):H.css({position:"relative"})})};this.remove=function(a){confirm("Are you sure you wish to delete "+w[a].name+"?")&&(delete w[a],o(),f())};this.j=function(a){var d=new Blob([window.JSON.stringify(w[a])],{type:"application/octet-stream"}),c=window.URL.createObjectURL(d),d=$(document.createElement("a"));d.attr("href",c);d.attr("download",a);a=document.createEvent("MouseEvents");a.initMouseEvent("click",s,B,window,
1,0,0,0,0,B,B,B,0,v);d[0].dispatchEvent(a);setTimeout(function(){window.URL.revokeObjectURL(c)},5E3)};this.i=function(){var e=new X(c,["Create","Cancel"],function(e){1==e||""==d.val().trim()||(a.push({name:d.val().trim(),type:"pack",version:"v1",data:[]}),k(),f())}),d=c.b({input:v,type:"text",size:"30"});e.c([{h4:"Add Pack"},{dl:[{dt:"Name:"},{dd:d}]}]);d.focus()};this.k=function(e){var d=c.save(),h=a[e],l=c.b({input:v,type:"text",val:h.name,size:"30"}),p=c.b({input:v,type:"text",val:h.version,size:"8"}),
e="";h.update!=n&&(e=h.update);var b=c.b({input:v,type:"text",val:e,size:"50"}),e=c.b({button:"Save",css:{"float":"right"}});e.click(function(){var a=l.val().trim();if(""==a)alert("You must give this pack a name");else{h.name=a;h.version=p.val().trim();a=b.val().trim();""!=a?h.update=a:delete h.update;h.data.splice(0,h.data.length);for(a=0;a<u.length;a++)u[a].checked&&h.data.push({type:u[a].type,id:u[a].id});$(window).unbind("scroll");c.restore(d);k();f()}});var j=c.b({button:"Cancel",css:{"float":"right"}});
j.click(function(){t();$(window).unbind("scroll");c.restore(d)});var q=c.b({div:[e,j,{br:v,css:{clear:"right"}}],"class":"buttonbar"}),e=c.b({div:v});c.c([{h1:"Modify Pack"},{table:[{tr:[{th:"Name:"},{td:l}]},{tr:[{th:"Version:"},{td:p}]},{tr:[{th:"Update:"},{td:b}]}]},q,e,{div:v,css:{height:"100px"}}]);l.focus();e.append(c.b(function(){var a=[];u=[];for(var b in i)u.push({type:"pre",id:b,checked:B});for(b in w)u.push({type:"local",id:b,checked:B});u.sort(function(a,b){return a.type==b.type?a.id==
b.id?0:a.id>b.id?1:-1:"pre"==a.type?1:-1});for(b=0;b<h.data.length;b++)for(var d=0;d<u.length;d++)if(h.data[b].type==u[d].type&&h.data[b].id==u[d].id){u[d].checked=s;break}for(b=0;b<u.length;b++){d=c.b({input:v,type:"checkbox",val:String(b)});u[b].checked&&d.attr("checked","checked");var e=c.b({label:[d,"local"==u[b].type?w[u[b].id].name+" ("+w[u[b].id].type+")":i[u[b].id].name+" ("+i[u[b].id].type+")"]});u[b].checked&&e.addClass("checked");d.change(function(a){$(a.target).is(":checked")?($(a.target.parentNode).addClass("checked"),
u[parseInt($(a.target).val(),10)].checked=s):($(a.target.parentNode).removeClass("checked"),u[parseInt($(a.target).val(),10)].checked=B)});a.push({tr:[{td:"local"==u[b].type?"Your Mod":"Pre-Made"},{td:e}]})}return{table:a}}()));var m=q.offset().top;$(window).scroll(function(){$(window).scrollTop()>m?q.css({position:"fixed"}):q.css({position:"relative"})});var u};this.l=function(e){confirm("Are you sure you wish to delete "+a[e].name+"?")&&(a.splice(e,1),k(),f())}};function U(){var f=$(document.createElement("div"));$(document.body).append(f);var c="select button option h1 h4 div br input dl dt dd table tr td th span a label".split(" ");this.save=function(){var c=f;c.hide();f=$(document.createElement("div"));$(document.body).append(f);return c};this.restore=function(c){f.remove();f=c;f.show()};this.clear=function(){f.empty()};this.b=function(f){for(var m=n,o=0;o<c.length;o++)if(c[o]in f){m=c[o];break}if(m===n)throw window.console.log(f),"Invalid DOM";var t=
$(document.createElement(m));if(f[m]!=v)if("string"==typeof f[m])t.html(f[m]);else if(f[m]instanceof jQuery)t.append(f[m]);else if(Array.isArray(f[m]))for(o=0;o<f[m].length;o++)"string"==typeof f[m][o]||f[m][o]instanceof jQuery?t.append(f[m][o]):t.append(this.b(f[m][o]));else t.append(this.b(f[m]));for(var k in f)k!=m&&("css"==k?t.css(f[k]):"class"==k?t.addClass(f[k]):"val"==k?t.val(f[k]):t.attr(k,f[k]));return t};this.c=function(c){if(c instanceof jQuery)f.append(c);else if(Array.isArray(c))for(var m=
0;m<c.length;m++)c[m]instanceof jQuery?f.append(c[m]):f.append(this.b(c[m]));else f.append(this.b(c))}}
function X(f,c,p){var m=f.b({div:v,"class":"dialogbg"});f.c(m);for(var o=f.b({div:v,"class":"content"}),t=[],k=0;k<c.length;k++){var x=f.b({button:c[k]});x.click(function(c){return function(){i.remove();m.remove();p(c)}}(k));t.push(x)}t.push({br:v,css:{clear:"both"}});var i=f.b({div:[o,{div:t,"class":"buttons"}],"class":"dialog"});f.c(i);i.keyup(function(c){return 13==c.keyCode||27==c.keyCode?(i.unbind("keyup"),i.remove(),m.remove(),p(27==c.keyCode?1:0),B):s});this.close=function(){i.remove();m.remove()};
this.c=function(c){if(c instanceof jQuery)o.append(c);else if(Array.isArray(c))for(var i=0;i<c.length;i++)c[i]instanceof jQuery?o.append(c[i]):o.append(f.b(c[i]));else o.append(f.b(c))}};function W(f,c){function p(a){if(a.isDirectory){w=0;for(var c in i)if(i[c].configs!=n){var e=a,d=i[c],h={name:d.name,type:d.type,version:d.version,data:[]};i[c]=h;for(var f=0;f<d.data.length;f++)h.data.push(jQuery.extend(s,{},d.data[f]));for(f=0;f<d.configs.length;f++)w++,m(e,d.configs[f],h)}}}function m(a,c,e){a.getFile(c,{},function(a){a.file(function(a){var d=new FileReader;d.onloadend=function(){for(var a={},b=[],d="",c=this.result.split(/\n|\r/),h=0;h<c.length;h++){var f=c[h];f.match(/#/)&&(f=
f.replace(/#.*/,""));f=f.trim();if(""!=f)if(f.match(/,/))for(var f=f.split(/,/),l=0;l<f.length;l++)o(b,a,f[l]);else if(f.match(/=/))o(b,a,f);else if(f.match(/{/))""==d?b.push(t(f.match(/^(.+){/)[1])):b.push(d),d="";else if(f.match(/}/))b.pop();else if(f.match(/\w/))d=t(f);else throw"unknown:"+f;}for(b=0;b<e.data.length;b++)e.data[b].config&&a[e.data[b].config]!=n&&(e.data[b].id=a[e.data[b].config],delete e.data[b].config);w--;0==w&&x()};d.onerror=function(a){window.console.log("error");window.console.log(a)};
d.readAsText(a)})},function(){alert("Couldn't find "+c)})}function o(a,c,e){if(e.match(/=/)){var e=e.split(/=/),d=e[0];d.match(/:/)&&(d=d.split(/:/)[1]);a.push(t(d));e=t(e[1]);$.isNumeric(e)&&(c[a.join(".")]=parseInt(e,10));a.pop()}}function t(a){for(a=a.trim();a.match(/"/);)a=a.replace(/^"(.*)"$/,"$1");return a}function k(a,c){var e=a.toLowerCase().replace(/[^a-z0-9]/g,""),d;switch(c){case "block":d="_ids.json";break;case "biome":d="_biomes.json";break;case "dimension":d="_dims.json"}for(var f=e+
d,k=1;f in i;)k++,f=e+k+d;return f}function x(){for(var a in i)if("pack"!=i[a].type){for(var c=i[a].data.length-1;0<=c;c--)i[a].data[c].config!==n&&i[a].data.splice(c,1);if(0==i[a].data.length){delete i[a];for(c=0;c<q.data.length;c++)if(q.data[c]==a){q.data.splice(c,1);break}}}c=[];for(a in i)c.push({name:a,file:window.JSON.stringify(i[a])});for(var e=[],d=0;256>d;d++){a=d;for(var f=0;8>f;f++)a=a&1?a>>>1^3988292384:a>>>1;e[d]=a}a=new Date;var k=a.getFullYear()-1980<<9|a.getMonth()+1<<5|a.getDate(),
m=[];a=[];for(var b=0,d=0;d<c.length;d++){c[d].offset=b;a[b++]=80;a[b++]=75;a[b++]=3;a[b++]=4;a[b++]=20;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=k&255;a[b++]=k>>8&255;for(var f=c[d].file,j=-1,p=0;p<f.length;p++)j=j>>>8^e[(j^f.charCodeAt(p))&255];m[d]=~j;a[b++]=m[d]&255;a[b++]=m[d]>>8&255;a[b++]=m[d]>>16&255;a[b++]=m[d]>>24&255;j=c[d].file.length;a[b++]=j&255;a[b++]=j>>8&255;a[b++]=j>>16&255;a[b++]=j>>24&255;a[b++]=j&255;a[b++]=j>>8&255;a[b++]=j>>16&255;a[b++]=j>>24&255;
a[b++]=c[d].name.length;a[b++]=0;a[b++]=0;for(f=a[b++]=0;f<c[d].name.length;f++)a[b++]=c[d].name.charCodeAt(f);for(f=0;f<j;f++)a[b++]=c[d].file.charCodeAt(f)}e=b;for(d=0;d<c.length;d++){a[b++]=80;a[b++]=75;a[b++]=1;a[b++]=2;a[b++]=20;a[b++]=0;a[b++]=20;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=k&255;a[b++]=k>>8&255;a[b++]=m[d]&255;a[b++]=m[d]>>8&255;a[b++]=m[d]>>16&255;a[b++]=m[d]>>24&255;j=c[d].file.length;a[b++]=j&255;a[b++]=j>>8&255;a[b++]=j>>16&255;a[b++]=j>>24&255;
a[b++]=j&255;a[b++]=j>>8&255;a[b++]=j>>16&255;a[b++]=j>>24&255;a[b++]=c[d].name.length;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;f=c[d].offset;a[b++]=f&255;a[b++]=f>>8&255;a[b++]=f>>16&255;a[b++]=f>>24&255;for(f=0;f<c[d].name.length;f++)a[b++]=c[d].name.charCodeAt(f)}d=b-e;a[b++]=80;a[b++]=75;a[b++]=5;a[b++]=6;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;c=c.length;a[b++]=c&255;a[b++]=c>>8&255;a[b++]=c&255;a[b++]=c>>8&255;a[b++]=d&
255;a[b++]=d>>8&255;a[b++]=d>>16&255;a[b++]=d>>24&255;a[b++]=e&255;a[b++]=e>>8&255;a[b++]=e>>16&255;a[b++]=e>>24&255;a[b++]=0;a[b++]=0;a=new Uint8Array(a);c=q.name.toLowerCase().replace(/[^a-z0-9]/g,"")+".zip";a=new Blob([a],{type:"application/zip"});var o=window.URL.createObjectURL(a);a=$(document.createElement("a"));a.attr("href",o);a.attr("download",c);c=document.createEvent("MouseEvents");c.initMouseEvent("click",s,B,window,1,0,0,0,0,B,B,B,0,v);a[0].dispatchEvent(c);setTimeout(function(){window.URL.revokeObjectURL(o)},
5E3)}var i,q;this.g=function(a,l){i={"pack_info.json":{type:"pack",data:[]}};q=i["pack_info.json"];if(l){var e=f.e[a];q.name=e.name;q.version=e.version;e.update!=n&&(q.update=e.update);for(var d=0;d<e.data.length;d++){var h;h="pre"==e.data[d].type?f.h[e.data[d].id]:f.d[e.data[d].id];var m=k(h.name,h.type);q.data.push(m);i[m]=h}}else{e=f.f[a];q.name=e.name;q.version=e.version;for(d=0;d<e.data.length;d++)h=f.h[e.data[d]],m=k(h.name,h.type),q.data.push(m),i[m]=h}e=B;for(d=0;d<q.data.length;d++)if(i[q.data[d]].configs!=
n){e=s;break}if(e){var o=c.b({div:v,"class":"dropbg"}),b=c.b({div:["Drop config folder here",{div:"Or click to cancel"}],"class":"dropmsg"}),j=c.b({div:v,"class":"dropbox"});c.c([o,b,j]);j.click(function(){j.remove();b.remove();o.remove()});j.bind({dragover:function(){o.addClass("hover");return B},dragleave:function(){o.removeClass("hover");return B},dragend:function(){o.removeClass("hover");return B},drop:function(a){j.remove();b.remove();o.remove();try{var c=a.originalEvent.dataTransfer.items[0];
if(c.getAsEntry)p(c.getAsEntry());else if(c.webkitGetAsEntry)p(c.webkitGetAsEntry());else throw"Not supported";}catch(d){alert(d)}return B}})}else x()};var w=0};
